# 빌드/서버 실행 가이드

## 📋 사전 요구사항

- Python 3.11+
- Node.js 18+
- PostgreSQL (또는 Supabase 계정)
- Redis (선택)

---

## 🔧 Backend 실행

### 1. 가상환경 생성 및 활성화

```bash
cd backend

# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

### 2. 의존성 설치

```bash
pip install -r requirements.txt
```

### 3. 환경 변수 설정

`.env` 파일 생성 (`.env.example` 참고):

```bash
# 최소 필수 환경 변수
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
SECRET_KEY=your-secret-key-here
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-supabase-anon-key
```

### 4. 데이터베이스 마이그레이션

```bash
# Alembic 초기화 (최초 1회)
alembic init alembic

# 마이그레이션 생성
alembic revision --autogenerate -m "Initial migration"

# 마이그레이션 실행
alembic upgrade head
```

### 5. 서버 실행

```bash
# 개발 모드 (Hot reload)
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# API 문서 확인
# http://localhost:8000/docs
```

---

## 🎨 Frontend 실행

### 1. 의존성 설치

```bash
cd frontend
npm install
```

### 2. 환경 변수 설정

`.env` 파일 생성 (`.env.example` 참고):

```bash
VITE_API_URL=http://localhost:8000/api/v1
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
VITE_ENV=development
```

### 3. 개발 서버 실행

```bash
npm run dev

# 접속: http://localhost:5173
```

### 4. 빌드 (프로덕션)

```bash
npm run build
npm run preview  # 빌드 결과 미리보기
```

---

## 🚀 루트에서 한 번에 실행 (권장)

### 1. 최초 1회 설정

```bash
# 프로젝트 루트에서

# 1. npm 의존성 설치
npm install

# 2. Backend 가상환경 생성 및 활성화
cd backend
python -m venv venv
venv\Scripts\activate  # Windows
# source venv/bin/activate  # macOS/Linux

# 3. Backend 의존성 설치
pip install -r requirements.txt
cd ..

# 4. Frontend 의존성 설치
cd frontend
npm install
cd ..
```

### 2. 환경 변수 설정

**backend/.env** 파일 생성:
```bash
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
SECRET_KEY=your-secret-key
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-supabase-key
```

**frontend/.env** 파일 생성:
```bash
VITE_API_URL=http://localhost:8000/api/v1
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-supabase-key
```

### 3. 한 번에 실행

```bash
# 프로젝트 루트에서
npm run dev
```

**접속 정보:**
- Frontend: http://localhost:5173
- Backend API: http://localhost:8000
- API Docs: http://localhost:8000/docs

**중지**: `Ctrl + C`

---

## 🐳 Docker Compose 실행 (선택)

```bash
docker-compose up -d  # 백그라운드 실행
docker-compose logs -f  # 로그 확인
docker-compose down  # 중지
```

---

## 🧪 기본 구조 확인 테스트

### 1. Backend API 테스트

```bash
# Health check
curl http://localhost:8000/api/v1/health

# API 문서 접속
# 브라우저: http://localhost:8000/docs
```

### 2. Frontend 접속

```bash
# 브라우저: http://localhost:5173
```

### 3. 데이터베이스 연결 확인

```bash
# Backend 로그에서 확인
# "Database connected successfully" 메시지 확인
```

---

## ⚠️ 현재 상태 (알아두기)

### ✅ 작동하는 것
- API 서버 실행 및 문서 접근
- 기본 엔드포인트 응답
- Frontend 개발 서버 실행
- 데이터베이스 연결

### ❌ 아직 작동 안 하는 것
- 이미지 업로드 (Storage 미구현)
- AI 기능 (Rembg, GPT-4 미연동)
- 인증 시스템 (Supabase Auth 미완성)
- SNS 공유 (UI 미구현)
- Frontend 페이지 (404)

→ **Placeholder 응답만 반환됨**

---

## 🔍 문제 해결

### Backend 실행 오류

```bash
# ModuleNotFoundError
pip install -r requirements.txt

# Database 연결 실패
# .env 파일의 DATABASE_URL 확인

# Port 이미 사용 중
uvicorn app.main:app --reload --port 8001
```

### Frontend 실행 오류

```bash
# 의존성 설치 오류
rm -rf node_modules package-lock.json
npm install

# Port 이미 사용 중
# vite.config.ts에서 port 변경
```

### Docker 실행 오류

```bash
# 컨테이너 재시작
docker-compose restart

# 전체 재빌드
docker-compose up --build

# 캐시 삭제 후 재시작
docker-compose down -v
docker-compose up --build
```

---

## 📝 간단한 테스트 시나리오

### 1. API 문서에서 테스트

1. http://localhost:8000/docs 접속
2. `POST /api/v1/projects` 확장
3. "Try it out" 클릭
4. Request body 입력:
   ```json
   {
     "name": "테스트 프로젝트",
     "description": "기본 구조 테스트"
   }
   ```
5. Execute → 401 Unauthorized 응답 (정상, 인증 미구현)

### 2. Frontend에서 확인

1. http://localhost:5173 접속
2. 현재: 기본 Vite 페이지 또는 404
3. 브라우저 콘솔에서 네트워크 요청 확인

---

## 다음 단계

기본 구조 확인 후:
1. Supabase 프로젝트 생성 및 연동
2. Storage 서비스 구현
3. AI 서비스 프로토타입 개발
4. Frontend UI 컴포넌트 작성
